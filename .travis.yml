language: rust
cache: cargo
sudo: required

rust:
  - nightly

services:
  - docker

after_success:
  - docker run --rm -it -v "$(pwd)":/home/rust/src ekidd/rust-musl-builder:nightly /bin/bash -c "rustup update; cargo build --release"
  - docker build --pull -t docker.io/tisoft/debitoor-extensions:latest .
  - docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";
  - docker push docker.io/tisoft/debitoor-extensions:latest